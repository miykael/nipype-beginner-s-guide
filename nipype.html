<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Nipype Beginner&#39;s Guide &mdash; All you need to know to become an expert in Nipype</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="All you need to know to become an expert in Nipype" href="index.html" />
    <link rel="next" title="Introduction to Neuroimaging" href="neuroimaging.html" />
    <link rel="prev" title="Welcome to Nipype Beginner’s Guide!" href="index.html" />
    <meta name="keywords" content="nipype, neuroimaging, pipeline, workflow, parallel, python, neuroscience, python, guide, mri, fmri, dti, tutorial, user guide">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-24958678-1', 'auto');
      ga('send', 'pageview');

    </script>

  </head>
  <body>

    <div class="headertext" >
     <a href="index.html">
        Nipype Beginner's Guide</a>
    </div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="neuroimaging.html" title="Introduction to Neuroimaging"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to Nipype Beginner’s Guide!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Home</a>|</li>
        <li><a href="http://miykael.github.com/nipype-beginner-s-guide/tableofcontent.html">Table of Contents</a>|</li>
        <li><a href="http://miykael.github.com/nipype-beginner-s-guide/faq.html">FAQ</a>|</li>
        <li><a href="http://miykael.github.com/nipype-beginner-s-guide/glossary.html">Glossary</a>|</li>
        <li><a href="https://github.com/miykael/nipype-beginner-s-guide/">github</a>|</li>
        <li><a href="http://nipy.org/nipype/">Nipype</a>|</li>
        <li><a href="http://miykael.github.io/nipype-beginner-s-guide/help.html">Help</a>|</li> 
      </ul>
    </div>
  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/nipype-beginners-guide-html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to Nipype</a><ul>
<li><a class="reference internal" href="#what-is-nipype">What is Nipype?</a></li>
<li><a class="reference internal" href="#a-short-example">A Short Example</a></li>
<li><a class="reference internal" href="#nipype-s-architecture">Nipype’s Architecture</a><ul>
<li><a class="reference internal" href="#interfaces">Interfaces</a></li>
<li><a class="reference internal" href="#workflow-engine">Workflow Engine</a></li>
<li><a class="reference internal" href="#execution-plugins">Execution Plugins</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Nipype Beginner’s Guide!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="neuroimaging.html"
                        title="next chapter">Introduction to Neuroimaging</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/nipype.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">

            
  <div class="admonition important">
<p class="admonition-title">Important</p>
<p>This guide hasn’t been updated since January 2017 and is based on an older version of Nipype. The code in this guide is not tested against newer Nipype versions and might not work anymore. For a newer, more up to date and better introduction to Nipype, please check out the the <a class="reference external" href="https://miykael.github.io/nipype_tutorial/">Nipype Tutorial</a>.</p>
</div>
<div class="section" id="introduction-to-nipype">
<h1>Introduction to Nipype<a class="headerlink" href="#introduction-to-nipype" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-nipype">
<h2>What is Nipype?<a class="headerlink" href="#what-is-nipype" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://nipype.readthedocs.io/en/latest/">Nipype</a> (Neuroimaging in Python - Pipelines and Interfaces) is an open-source, user-friendly, community-developed software package under the umbrella of <a class="reference external" href="http://nipy.org/">NiPy</a>. Nipype allows you to pipeline your neuroimaging workflow in an intuitive way and enables you to use the software packages and algorithms you want to use, regardless their programing language. This is possible because Nipype provides an uniform interface to many existing neuroimaging processing and analysis packages like <a class="reference external" href="http://www.fil.ion.ucl.ac.uk/spm">SPM</a>, <a class="reference external" href="http://surfer.nmr.mgh.harvard.edu/">FreeSurfer</a>, <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/">FSL</a>, <a class="reference external" href="https://afni.nimh.nih.gov/afni/">AFNI</a>, <a class="reference external" href="http://stnava.github.io/ANTs/">ANTS</a>, <a class="reference external" href="http://camino.cs.ucl.ac.uk/">Camino</a>, <a class="reference external" href="http://www.brain.org.au/software/mrtrix/index.html">MRtrix</a>, <a class="reference external" href="http://slicer.org/">Slicer</a>, <a class="reference external" href="https://martinos.org/mne/stable/index.html">MNE</a> and many more.</p>
<p>Nipype allows you to easily combine all those heterogeneous software packages whithin a single workflow. This procedure gives you the opportunity to pick the best algorithm there is for the problem at hand and therefore allows you to profit from the advantages of any software package you like.</p>
<p>Nipype is written in <a class="reference external" href="https://www.python.org/">Python</a>, an easy to learn and very intuitive programming language. This means that your whole neuroimaging analysis can be easily specified using python scripts. It won’t even take as many lines of code as you might fear. Nipype is very straightforward and easy to learn. As you will see, it is quite simple to combine processing steps using different software packages. Steps from previous analyses can be reused effortlessly and new approaches can be applied much faster.</p>
<p>You’re still concerned because you want to combine your own <strong>bash</strong>, <strong>MATLAB</strong>, <strong>R</strong> or <strong>Python</strong> scripts with Nipype? No problem! Even the creation of your own interface to your own software solution is straightforward and can be done in a rather short time. Thanks to <a class="reference external" href="https://github.com/nipy/nipype">Github</a>, there’s also always a community standing behind you.</p>
<p>Nipype provides an environment that encourages interactive exploration of algorithms. It allows you to make your research easily reproducible and lets you share your code with the community.</p>
</div>
<div class="section" id="a-short-example">
<h2>A Short Example<a class="headerlink" href="#a-short-example" title="Permalink to this headline">¶</a></h2>
<p>Let’s assume you want to do an Analysis that uses <strong>AFNI</strong> for the <em>Motion Correction</em>, <strong>FreeSurfer</strong> for the <em>Coregistration</em>, <strong>ANTS</strong> for the <em>Normalization</em>, <strong>FSL</strong> for the <em>Smoothing</em>, <strong>Nipype</strong> for the <em>Model Specification</em>, <strong>SPM</strong> for the <em>Model Estimation</em> and <strong>SPM</strong> for the <em>Statistical Inference</em>. Normally this would be a hell of a mess. Switching between multiple scripts in different programming languages with a lot of manual intervention. On top of all that, you want to do your analysis on multiple subjects, preferably as fast as possible, i.e., processing several subjects in parallel. With Nipype, this is no problem! You can do all this and much more.</p>
<p>To illustrate the straightforwardness of an Nipype workflow and show how simply it can be created, look at the following example. This figure shows you a simplification of the analysis <em>workflow</em> just outlined.</p>
<div class="graphviz"><img src="_images/graphviz-15f3e6984796a80f0e02d6da4a457b70ba79e8d4.png" alt="strict digraph  {

    dataset[label=&quot;rawdata&quot;, shape=box3d,style=filled, color=black, colorscheme=greys7 fillcolor=2];
    datastorage[label=&quot;output&quot;, shape=box3d,style=filled, color=black, colorscheme=greys7 fillcolor=2];

    sub1[label=&quot;Subject1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    afni1[label=&quot;Motion Correction (AFNI) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    coreg1[label=&quot;Coregistration (FreeSurfer) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    norm1[label=&quot;Normalization (ANTS) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    smooth1[label=&quot;Smoothing (FSL) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    spec1[label=&quot;Model Specification (Nipype) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    est1[label=&quot;Model Estimation (SPM) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];
    stat1[label=&quot;Statistical Inference (SPM) - Sub1&quot;, style=filled, fillcolor=&quot;#E6E6FF&quot;];

    sub2[label=&quot;Subject2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    afni2[label=&quot;Motion Correction (AFNI) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    coreg2[label=&quot;Coregistration (FreeSurfer) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    norm2[label=&quot;Normalization (ANTS) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    smooth2[label=&quot;Smoothing (FSL) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    spec2[label=&quot;Model Specification (Nipype) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    est2[label=&quot;Model Estimation (SPM) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];
    stat2[label=&quot;Statistical Inference (SPM) - Sub2&quot;, style=filled, fillcolor=&quot;#FFE6E6&quot;];

    sub3[label=&quot;Subject3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    afni3[label=&quot;Motion Correction (AFNI) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    coreg3[label=&quot;Coregistration (FreeSurfer) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    norm3[label=&quot;Normalization (ANTS) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    smooth3[label=&quot;Smoothing (FSL) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    spec3[label=&quot;Model Specification (Nipype) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    est3[label=&quot;Model Estimation (SPM) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];
    stat3[label=&quot;Statistical Inference (SPM) - Sub3&quot;, style=filled, fillcolor=&quot;#E6FFE6&quot;];

    dataset -&gt; sub1;
    dataset -&gt; sub2;
    dataset -&gt; sub3;

    subgraph flow1 {
            edge [color=&quot;#0000FF&quot;];
        sub1 -&gt; afni1 -&gt; coreg1 -&gt; norm1 -&gt; smooth1 -&gt; spec1 -&gt; est1 -&gt; stat1;
    }

    subgraph flow2 {
            edge [color=&quot;#FF0000&quot;];
        sub2 -&gt; afni2 -&gt; coreg2 -&gt; norm2 -&gt; smooth2 -&gt; spec2 -&gt; est2 -&gt; stat2;
    }

    subgraph flow3 {
            edge [color=&quot;#00A300&quot;];
        sub3 -&gt; afni3 -&gt; coreg3 -&gt; norm3 -&gt; smooth3 -&gt; spec3 -&gt; est3 -&gt; stat3;
    }

    stat1 -&gt; datastorage;
    stat2 -&gt; datastorage;
    stat3 -&gt; datastorage;

}" class="graphviz" /></div>
<p>The code to create an Nipype workflow that specifies the steps illustrated in the figure above and can run all the steps would look something like this:</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#Import modules</span>
<span class="kn">import</span> <span class="nn">nipype</span>
<span class="kn">import</span> <span class="nn">nipype.interfaces.afni</span>        <span class="k">as</span> <span class="nn">afni</span>
<span class="kn">import</span> <span class="nn">nipype.interfaces.freesurfer</span>  <span class="k">as</span> <span class="nn">fs</span>
<span class="kn">import</span> <span class="nn">nipype.interfaces.ants</span>        <span class="k">as</span> <span class="nn">ants</span>
<span class="kn">import</span> <span class="nn">nipype.interfaces.fsl</span>         <span class="k">as</span> <span class="nn">fsl</span>
<span class="kn">import</span> <span class="nn">nipype.interfaces.nipy</span>        <span class="k">as</span> <span class="nn">nipy</span>
<span class="kn">import</span> <span class="nn">nipype.interfaces.spm</span>         <span class="k">as</span> <span class="nn">spm</span>


<span class="c1">#Specify experiment specifc parameters</span>
<span class="n">experiment_dir</span> <span class="o">=</span> <span class="s1">&#39;~/experiment_folder&#39;</span>
<span class="n">nameofsubjects</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;subject1&#39;</span><span class="p">,</span><span class="s1">&#39;subject2&#39;</span><span class="p">,</span><span class="s1">&#39;subject3&#39;</span><span class="p">]</span>

<span class="c1">#Where can the raw data be found?</span>
<span class="n">grabber</span> <span class="o">=</span> <span class="n">nipype</span><span class="o">.</span><span class="n">DataGrabber</span><span class="p">()</span>
<span class="n">grabber</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">experiment_dir</span> <span class="o">+</span> <span class="s1">&#39;/data&#39;</span>
<span class="n">grabber</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">subject_id</span> <span class="o">=</span> <span class="n">nameofsubjects</span>

<span class="c1">#Where should the output data be stored at?</span>
<span class="n">sink</span> <span class="o">=</span> <span class="n">nipype</span><span class="o">.</span><span class="n">DataSink</span><span class="p">()</span>
<span class="n">sink</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">experiment_dir</span> <span class="o">+</span> <span class="s1">&#39;/output_folder&#39;</span>


<span class="c1">#Create a node for each step of the analysis</span>

<span class="c1">#Motion Correction (AFNI)</span>
<span class="n">realign</span> <span class="o">=</span> <span class="n">afni</span><span class="o">.</span><span class="n">Retroicor</span><span class="p">()</span>

<span class="c1">#Coregistration (FreeSurfer)</span>
<span class="n">coreg</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">BBRegister</span><span class="p">()</span>

<span class="c1">#Normalization (ANTS)</span>
<span class="n">normalize</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">WarpTimeSeriesImageMultiTransform</span><span class="p">()</span>

<span class="c1">#Smoothing (FSL)</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">SUSAN</span><span class="p">()</span>
<span class="n">smooth</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="mf">6.0</span>

<span class="c1">#Model Specification (Nipype)</span>
<span class="n">modelspec</span> <span class="o">=</span> <span class="n">nipype</span><span class="o">.</span><span class="n">SpecifyModel</span><span class="p">()</span>
<span class="n">modelspec</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">input_units</span> <span class="o">=</span> <span class="s1">&#39;secs&#39;</span>
<span class="n">modelspec</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_repetition</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">modelspec</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">high_pass_filter_cutoff</span> <span class="o">=</span> <span class="mf">128.</span>

<span class="c1">#Model Estimation (SPM)</span>
<span class="n">modelest</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">EstimateModel</span><span class="p">()</span>

<span class="c1">#Contrast Estimation (SPM)</span>
<span class="n">contrastest</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">EstimateContrast</span><span class="p">()</span>
<span class="n">cont1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;human_faces&#39;</span><span class="p">,</span>  <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">cont2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;animal_faces&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">contrastest</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">contrasts</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont1</span><span class="p">,</span> <span class="n">cont2</span><span class="p">]</span>

<span class="c1">#Statistical Inference (SPM)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">Threshold</span><span class="p">()</span>
<span class="n">threshold</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">use_fwe_correction</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">threshold</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extent_fdr_p_threshold</span> <span class="o">=</span> <span class="mf">0.05</span>


<span class="c1">#Create a workflow to connect all those nodes</span>
<span class="n">analysisflow</span> <span class="o">=</span> <span class="n">nipype</span><span class="o">.</span><span class="n">Workflow</span><span class="p">()</span>

<span class="c1">#Connect the nodes to each other</span>
<span class="n">analysisflow</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">grabber</span>     <span class="o">-&gt;</span>  <span class="n">realign</span>    <span class="p">),</span>
                      <span class="p">(</span><span class="n">realign</span>     <span class="o">-&gt;</span>  <span class="n">coreg</span>      <span class="p">),</span>
                      <span class="p">(</span><span class="n">coreg</span>       <span class="o">-&gt;</span>  <span class="n">normalize</span>  <span class="p">),</span>
                      <span class="p">(</span><span class="n">normalize</span>   <span class="o">-&gt;</span>  <span class="n">smooth</span>     <span class="p">),</span>
                      <span class="p">(</span><span class="n">smooth</span>      <span class="o">-&gt;</span>  <span class="n">modelspec</span>  <span class="p">),</span>
                      <span class="p">(</span><span class="n">modelspec</span>   <span class="o">-&gt;</span>  <span class="n">modelest</span>   <span class="p">),</span>
                      <span class="p">(</span><span class="n">modelest</span>    <span class="o">-&gt;</span>  <span class="n">contrastest</span><span class="p">),</span>
                      <span class="p">(</span><span class="n">contrastest</span> <span class="o">-&gt;</span>  <span class="n">threshold</span>  <span class="p">),</span>
                      <span class="p">(</span><span class="n">threshold</span>   <span class="o">-&gt;</span>  <span class="n">sink</span>       <span class="p">)</span>
                      <span class="p">])</span>

<span class="c1">#Run the workflow in parallel</span>
<span class="n">analysisflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;parallel&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>By using <em>multicore processing</em>, <em>SGE</em>, <em>PBS</em>, <em>Torque</em>, <em>HTCondor</em>, <em>LSF</em> or other plugins for parallel execution you will be able to reduce your computation time considerably. This means, that an analysis of 24 subjects where each takes one hour to process would normally take about one day, but it could be done on a single machine with eight processors in under about three hours.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code above is of course a shortened and simplified version of the real code. But it gives you a good idea of what the code would look like, and how straightforward and readable the programming of a neuroimaging pipeline with Nipype is.</p>
</div>
</div>
<div class="section" id="nipype-s-architecture">
<h2>Nipype’s Architecture<a class="headerlink" href="#nipype-s-architecture" title="Permalink to this headline">¶</a></h2>
<p>Nipype consists of many parts, but the most important ones are <strong>Interfaces</strong>, the <strong>Workflow Engine</strong> and the <strong>Execution Plugins</strong>.</p>
<img alt="_images/architecture.png" class="align-center" src="_images/architecture.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a deeper understanding of Nipype go either to <a class="reference external" href="http://nipype.readthedocs.io/en/latest/">Nipype’s main homepage</a> or read the official paper: Gorgolewski K, Burns CD, Madison C, Clark D, Halchenko YO, Waskom ML, Ghosh SS (2011) <strong>Nipype: a flexible, lightweight and extensible neuroimaging data processing framework in Python.</strong> <em>Front. Neuroinform. 5:13</em>. <a class="reference external" href="http://journal.frontiersin.org/article/10.3389/fninf.2011.00013/abstract">http://dx.doi.org/10.3389/fninf.2011.00013</a></p>
</div>
<div class="section" id="interfaces">
<h3>Interfaces<a class="headerlink" href="#interfaces" title="Permalink to this headline">¶</a></h3>
<p>Interfaces in the context of Nipype are program wrappers that enable Nipype, which runs in Python, to run a program or function in any other programming language. As a result, Python becomes the common denominator of all neuroimaging software packages and allows Nipype to easily connect them to each other. A short tutorial about interfaces can be found on the <a class="reference external" href="http://nipype.readthedocs.io/en/latest/users/interface_tutorial.html">official homepage</a>. More practical examples will be given later in this beginner’s guide.</p>
<p>For a full list of software interfaces supported by Nipype go <a class="reference external" href="http://nipype.readthedocs.io/en/latest/documentation.html">here</a>.</p>
</div>
<div class="section" id="workflow-engine">
<h3>Workflow Engine<a class="headerlink" href="#workflow-engine" title="Permalink to this headline">¶</a></h3>
<p>The core of Nipype’s architecture is the workflow engine. It consists of <strong>Nodes</strong>, <strong>MapNodes</strong> and <strong>Workflows</strong>, which can be interconnected in various ways.</p>
<ul class="simple">
<li><p><strong>Node</strong>: A node provides the information – parameters, filenames, etc. – that is needed by an interface to run the program properly for a particular job, whether as part of a workflow or separately.</p></li>
<li><p><strong>MapNode</strong>: A Mapnode is quite similar to a Node, but it differs because it takes multiple inputs of a single type to create a single output. For example, it might specify multiple DICOM files to create one NIfTI file.</p></li>
<li><p><strong>Workflow</strong>: A workflow (also called a pipeline), is a directed acyclic graph (DAG) or forest of graphs whose nodes are of type Node, MapNode or Workflow and whose edges (lines connecting nodes) represent data flow.</p></li>
</ul>
<p>Each Node, MapNode or Workflow has (at least) one input field and (at least) one output field. Those fields specify the dataflow into and out of a Node, MapNode or Workflow. MapNodes use fields to specify multiple inputs (basically a list of input items). There they are called <em>iterfields</em> because the interface will iterate over the list of input items, and they have to be labeled as such to distinguish them from single-item fields.</p>
<p>A very cool feature of a Nipype workflow are so called <strong>iterables</strong>. Iterables allow you to run a given workflow or subgraph several times with changing input values. For example, if you want to run an analysis pipeline on multiple subjects or with an FWHM smoothing kernel of 4mm, 6mm, and 8mm. This can easily be achieved with iterables and additionally allows you to do this all in parallel (simultaneous execution), if requested.</p>
<p>Go to the documentation section of <a class="reference external" href="http://nipype.readthedocs.io/en/latest/">Nipype’s main homepage</a> to read more about <a class="reference external" href="http://nipype.readthedocs.io/en/latest/users/mapnode_and_iterables.html">MapNode, iterfield, and iterables</a>, <a class="reference external" href="http://nipype.readthedocs.io/en/latest/users/joinnode_and_itersource.html">JoinNode, synchronize and itersource</a> and <a class="reference external" href="http://nipype.readthedocs.io/en/latest/users/pipeline_tutorial.html">much more</a>. Nonetheless, a more detailed explanation will be given in a <a class="reference external" href="http://miykael.github.io/nipype-beginner-s-guide/firstSteps.html#specify-workflows-connect-nodes">later section</a> of this beginner’s guide.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more practical and extended examples of Nipype concepts see <a class="reference external" href="https://github.com/mwaskom">Michael Waskom</a>’s really cool Jupyter notebooks about <a class="reference external" href="http://nbviewer.jupyter.org/github/mwaskom/nipype_concepts/blob/master/interfaces.ipynb">Interfaces</a>, <a class="reference external" href="http://nbviewer.jupyter.org/github/mwaskom/nipype_concepts/blob/master/iteration.ipynb">Iteration</a> and <a class="reference external" href="http://nbviewer.jupyter.org/github/mwaskom/nipype_concepts/blob/master/workflows.ipynb">Workflows</a>.</p>
</div>
</div>
<div class="section" id="execution-plugins">
<h3>Execution Plugins<a class="headerlink" href="#execution-plugins" title="Permalink to this headline">¶</a></h3>
<p>Plugins are components that describe how a workflow should be executed. They allow seamless execution across many architectures and make using parallel computation quite easy.</p>
<p>On a local machine, you can use the plugin <strong>Serial</strong> for a linear, or serial, execution of your workflow. If you machine has more than one core, you can use the <strong>Multicore</strong> plugin for parallel execution of your workflow. On a cluster, you have the option of using plugins for:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>HTCondor</strong></p></li>
<li><p><strong>PBS, Torque, SGE, LSF</strong> (native and via IPython)</p></li>
<li><p><strong>SSH</strong> (via IPython)</p></li>
<li><p><strong>Soma Workflow</strong></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cluster operation often needs a special setup. You may wish to consult your cluster operators about which plugins are available.</p>
</div>
<p>To show how easily this can be done, the following code shows how to run a workflow with different plugins:</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Normally calling run executes the workflow in series</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># But you can scale to parallel very easily.</span>
<span class="c1"># For example, to use multiple cores on your local machine</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;MultiProc&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_procs&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>

<span class="c1"># or to other job managers</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;PBS&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;qsub_args&#39;</span><span class="p">:</span> <span class="s1">&#39;-q many&#39;</span><span class="p">})</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;SGE&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;qsub_args&#39;</span><span class="p">:</span> <span class="s1">&#39;-q many&#39;</span><span class="p">})</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;LSF&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;qsub_args&#39;</span><span class="p">:</span> <span class="s1">&#39;-q many&#39;</span><span class="p">})</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Condor&#39;</span><span class="p">)</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;IPython&#39;</span><span class="p">)</span>

<span class="c1"># or submit graphs as a whole</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;PBSGraph&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;qsub_args&#39;</span><span class="p">:</span> <span class="s1">&#39;-q many&#39;</span><span class="p">})</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;SGEGraph&#39;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;qsub_args&#39;</span><span class="p">:</span> <span class="s1">&#39;-q many&#39;</span><span class="p">})</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;CondorDAGMan&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>More about Plugins can be found on Nipype’s main homepage under <a class="reference external" href="http://nipype.readthedocs.io/en/latest/users/plugins.html">Using Nipype Plugins</a>.</p>
</div>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="neuroimaging.html" title="Introduction to Neuroimaging"
             >next</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to Nipype Beginner’s Guide!"
             >previous</a> |</li>
        <li><a href="index.html">Home</a>|</li>
        <li><a href="http://miykael.github.com/nipype-beginner-s-guide/tableofcontent.html">Table of Contents</a>|</li>
        <li><a href="http://miykael.github.com/nipype-beginner-s-guide/faq.html">FAQ</a>|</li>
        <li><a href="http://miykael.github.com/nipype-beginner-s-guide/glossary.html">Glossary</a>|</li>
        <li><a href="https://github.com/miykael/nipype-beginner-s-guide/">github</a>|</li>
        <li><a href="http://nipy.org/nipype/">Nipype</a>|</li>
        <li><a href="http://miykael.github.io/nipype-beginner-s-guide/help.html">Help</a>|</li> 
      </ul>
    </div>
    <div class="footer">
    <p>
        &copy; Copyright 2016, Michael Notter.
      Last updated on June 10, 2021.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.2.1.
    </p>
    <p>
    This page uses <a href="http://analytics.google.com/">Google Analytics</a> to collect statistics. You can disable it by blocking the JavaScript coming from www.google-analytics.com.
    </p>
    </div>
  </body>
</html>